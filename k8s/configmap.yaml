apiVersion: v1
kind: ConfigMap
metadata:
  name: agent-app-config
  namespace: agent-application
  labels:
    app.kubernetes.io/name: agent-application
    app.kubernetes.io/component: config
data:
  application.yml: |
    spring:
      application:
        name: agent-application
      profiles:
        active: kubernetes
      datasource:
        url: jdbc:postgresql://postgres-service:5432/agentdb
        driver-class-name: org.postgresql.Driver
        hikari:
          maximum-pool-size: 20
          minimum-idle: 10
          idle-timeout: 300000
          connection-timeout: 20000
          validation-timeout: 5000
      jpa:
        hibernate:
          ddl-auto: update
        show-sql: false
        properties:
          hibernate:
            dialect: org.hibernate.dialect.PostgreSQLDialect
            format_sql: false
      data:
        redis:
          host: redis-service
          port: 6379
          timeout: 2000ms
          lettuce:
            pool:
              max-active: 16
              max-idle: 8
              min-idle: 4
    server:
      port: 8080
      servlet:
        context-path: /api
    management:
      endpoints:
        web:
          exposure:
            include: health,info,metrics,prometheus
      endpoint:
        health:
          show-details: when-authorized
          show-components: when-authorized
      health:
        redis:
          enabled: true
        diskspace:
          enabled: true
        db:
          enabled: true
      metrics:
        export:
          prometheus:
            enabled: true
    logging:
      level:
        com.agent: INFO
        org.springframework.security: WARN
      pattern:
        console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level [%X{traceId:-},%X{spanId:-}] %logger{36} - %msg%n"
    agent:
      llm:
        providers:
          openai:
            enabled: false
            base-url: https://api.openai.com/v1
          anthropic:
            enabled: false
            base-url: https://api.anthropic.com/v1
          ollama:
            enabled: true
            base-url: http://ollama-service:11434
      token:
        default-limits:
          max-tokens-per-request: 4000
          max-tokens-per-conversation: 50000
          max-tokens-per-day: 100000
      memory:
        short-term-enabled: true
        long-term-enabled: true
        short-term-ttl-minutes: 60
        max-conversation-history: 100
      tools:
        enabled-by-default: true
        timeout-seconds: 30
      monitoring:
        metrics:
          enabled: true
          prefix: agent
          tags:
            environment: kubernetes
        tracing:
          enabled: true
          service-name: agent-application
          sampling-rate: 0.1
        health:
          detailed-enabled: true
          timeout-seconds: 10